# ğŸ“œ **ã€Šç”Ÿäº§çº§æ™ºèƒ½åˆçº¦å¼€å‘ç¯å¢ƒæ„å»ºç™½çš®ä¹¦ã€‹**  
## â€”â€” å‡è®¾åŸºäº Hardhat v3.0.6 çš„æ’æ§½å¼ç»„ä»¶é›†æˆæ–¹æ¡ˆ

> **ä½œè€…**ï¼šä¸€ä½è¿½æ±‚ç¡®å®šæ€§å¼€å‘ä½“éªŒçš„ RainWeb3
> **ç›®æ ‡**ï¼šæ„å»ºä¸€ä¸ª**å¯å¤ç°ã€é›¶è¸©å‘ã€å…¨èƒ½åŠ›è¦†ç›–**çš„æ™ºèƒ½åˆçº¦å¼€å‘ç¯å¢ƒ  
> **æ ¸å¿ƒåŸåˆ™**ï¼š**ç‰ˆæœ¬é”å®š + åŠŸèƒ½å®Œå¤‡ + é…ç½®å³ä»£ç **

# æœŸæœ›å®˜æ–¹æœªæ¥å¯ä»¥å‘æ’æ§½å¼ç»„ä»¶å…¨æ ˆé›†æˆæ–¹æ¡ˆæ¼”è¿›
# ç›®å‰æ¥è§¦web3ï¼Œç¬¬88å¤©ã€‚

èšç„¦äºï¼š

1. âœ… **æ™ºèƒ½åˆçº¦æ¶æ„æ­å»ºçš„çœŸå®ç—›ç‚¹**
2. âœ… **ä¸ºä»€ä¹ˆå¿…é¡»é‡‡ç”¨ Hardhat + Foundry æ··åˆæ¶æ„**
3. âœ… **ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯â€œæ’æ§½å¼â€è€Œéâ€œæ’ä»¶å¼â€**
4. âœ… **ä»¥ Hardhat v3.0.6 ä¸ºé”šç‚¹ï¼Œå¦‚ä½•é”å®šæ‰€æœ‰ç»„ä»¶ç‰ˆæœ¬å¹¶å®ç°æ— ç¼é›†æˆ**
5. âœ… **æ¯ä¸ªé›†æˆç»„ä»¶çš„ä½œç”¨ã€è§£å†³çš„é—®é¢˜ã€å¸¦æ¥çš„èƒ½åŠ›**
---

## ä¸€ã€ç”Ÿäº§çº§æ™ºèƒ½åˆçº¦æ¶æ„çš„äº”å¤§çœŸå®ç—›ç‚¹

å½“å‰ 90% çš„æ™ºèƒ½åˆçº¦é¡¹ç›®åœ¨ç¯å¢ƒæ­å»ºé˜¶æ®µå°±å·²åŸ‹ä¸‹éšæ‚£ã€‚ä»¥ä¸‹æ˜¯å¼€å‘è€…æ¯å¤©é¢å¯¹çš„çœŸå®é—®é¢˜ï¼š

| ç—›ç‚¹ | å…·ä½“è¡¨ç° | åæœ |
|------|----------|------|
| ğŸ”§ **ç¯å¢ƒä¸å¯å¤ç°** | `node_modules` åœ¨ä¸åŒæœºå™¨ä¸Šè¡Œä¸ºä¸åŒ | CI é€šè¿‡ï¼Œæœ¬åœ°å¤±è´¥ |
| ğŸ”„ **ç‰ˆæœ¬ç»„åˆçˆ†ç‚¸** | `hardhat@3.0.6` ä¸ `solidity-coverage@0.8.6` æ˜¯å¦å…¼å®¹ï¼Ÿæ— äººçŸ¥é“ | ç¼–è¯‘å¤±è´¥ã€è¦†ç›–ç‡ä¸¢å¤± |
| ğŸ§© **å·¥å…·å‰²è£‚** | Prettier æ ¼å¼åŒ–å Solhint æŠ¥é”™ | å¼€å‘è€…è¢«è¿«æ‰‹åŠ¨è°ƒæ•´ |
| ğŸ¤– **AI è¾“å‡ºå¤±æ•ˆ** | AI å»ºè®®ä½¿ç”¨ `@nomiclabs/hardhat-waffle`ï¼ˆå·²åºŸå¼ƒï¼‰ | æ–°é¡¹ç›®ç›´æ¥è¸©å‘ |
| ğŸš§ **èƒ½åŠ›ç¼ºå¤±** | ç¼ºå°‘ Commitlintã€ESLintï¼Œä»£ç é£æ ¼æ··ä¹± | å›¢é˜Ÿåä½œæ•ˆç‡ä½ä¸‹ |

è¿™äº›é—®é¢˜çš„æ ¹æºï¼š**ç¼ºä¹ä¸€ä¸ªä»¥ä¸»æ¡†æ¶ç‰ˆæœ¬ä¸ºé”šç‚¹çš„â€œå…¨æ ˆé›†æˆæ–¹æ¡ˆâ€**ã€‚

---

## äºŒã€ä¸ºä»€ä¹ˆå¿…é¡»é‡‡ç”¨ Hardhat + Foundry æ··åˆæ¶æ„ï¼Ÿ

### 2.1 å•ä¸€å·¥å…·æ— æ³•æ»¡è¶³ç”Ÿäº§çº§éœ€æ±‚

| éœ€æ±‚ | Hardhat èƒ½åŠ› | Foundry èƒ½åŠ› | ç»“è®º |
|------|--------------|--------------|------|
| å¿«é€ŸåŸå‹å¼€å‘ | âœ… å¼ºå¤§ | âœ… æå¼º | Foundry æ›´ä¼˜ |
| å¤æ‚éƒ¨ç½²æµç¨‹ | âœ… æå¼ºï¼ˆJS/TS è„šæœ¬ï¼‰ | âš ï¸ æœ‰é™ï¼ˆéœ€å¤æ‚ Forge è„šæœ¬ï¼‰ | Hardhat æ›´ä¼˜ |
| å•å…ƒæµ‹è¯• | âœ… JS æ–­è¨€çµæ´» | âœ… Forge æµ‹è¯•æ›´å¿«ã€æ”¯æŒ fuzzing | äº’è¡¥ |
| å½¢å¼åŒ–éªŒè¯ | âŒ | âœ… æ”¯æŒ Echidnaã€Invariant Testing | Foundry å¿…éœ€ |
| Gas æ¯”è¾ƒ | âš ï¸ ç²—ç•¥ | âœ… ç²¾ç¡®åˆ°æŒ‡ä»¤çº§ | Foundry å¿…éœ€ |
| CI/CD é›†æˆ | âœ… æˆç†Ÿ | âœ… æˆç†Ÿ | æ— å·®å¼‚ |

> âœ… **ç»“è®º**ï¼š  
> - **Hardhat ä½œä¸ºä¸»æ¡†æ¶**ï¼šè´Ÿè´£é¡¹ç›®ç»„ç»‡ã€å¤æ‚éƒ¨ç½²ã€ä¸å‰ç«¯é›†æˆã€CI æµç¨‹æ§åˆ¶ã€‚  
> - **Foundry ä½œä¸ºèƒ½åŠ›è¡¥å……**ï¼šæä¾›é«˜çº§æµ‹è¯•ï¼ˆfuzzing/invariantsï¼‰ã€ç²¾ç¡® gas åˆ†æã€å½¢å¼åŒ–éªŒè¯ã€‚

è¿™ä¸æ˜¯â€œäºŒé€‰ä¸€â€ï¼Œè€Œæ˜¯â€œä¸»è¾…ååŒâ€ã€‚

---

## ä¸‰ã€ä¸ºä»€ä¹ˆå¿…é¡»æ˜¯â€œæ’æ§½å¼â€è€Œéâ€œæ’ä»¶å¼â€ï¼Ÿ

### 3.1 â€œæ’ä»¶å¼â€çš„å±€é™

å½“å‰ Hardhat çš„æ’ä»¶æœºåˆ¶ï¼ˆ`usePlugin`ï¼‰å­˜åœ¨è‡´å‘½ç¼ºé™·ï¼š
- âŒ æ’ä»¶ä¹‹é—´æ— ä¾èµ–ç®¡ç†ï¼ˆå¦‚ `hardhat-contract-sizer` å’Œ `solidity-coverage` å¯èƒ½å†²çªï¼‰
- âŒ æ— ç‰ˆæœ¬å…¼å®¹æ€§å£°æ˜
- âŒ æ’ä»¶ä½œè€…å¯èƒ½å¼ƒå‘ï¼ˆå¦‚ `hardhat-gas-reporter` å·²é•¿æœŸä¸ç»´æŠ¤ï¼‰

### 3.2 â€œæ’æ§½å¼â€çš„æ­£ç¡®æŠ½è±¡

æˆ‘ä»¬åº”å°†å¼€å‘ç¯å¢ƒè§†ä¸ºä¸€ä¸ª**åŠŸèƒ½å®Œå¤‡çš„ç³»ç»Ÿ**ï¼Œæ¯ä¸ªç»„ä»¶å¡«å……ä¸€ä¸ªâ€œèƒ½åŠ›æ§½ä½â€ï¼š

| æ’æ§½ç±»å‹ | åŠŸèƒ½èŒè´£ | å¯é€‰å®ç° |
|--------|----------|----------|
| `Code Formatting` | ç»Ÿä¸€ä»£ç é£æ ¼ | Prettier |
| `Linting` | é™æ€æ£€æŸ¥ | Solhint, ESLint |
| `Security Analysis` | æ¼æ´æ‰«æ | Slither, MythX |
| `Testing` | å•å…ƒ/é›†æˆæµ‹è¯• | Hardhat Test, Forge Test |
| `Fuzzing & Invariants` | æ·±åº¦æµ‹è¯• | Foundry Fuzzing |
| `Deployment` | ä¸Šé“¾éƒ¨ç½² | Hardhat Deploy, Forge Script |
| `CI/CD Governance` | æäº¤è§„èŒƒ | Commitlint, Husky |

> âœ… **å…³é”®æ€æƒ³**ï¼š  
> - æ¯ä¸ªæ’æ§½**æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªä¸»å®ç°**ï¼ˆé¿å…å†²çªï¼‰
> - å®ç°çš„é€‰æ‹©ç”±**ä¸»æ¡†æ¶ç‰ˆæœ¬å†³å®š**
> - æ‰€æœ‰é…ç½®åº”**ç‰ˆæœ¬åŒ–ã€ä»£ç åŒ–ã€å¯å¤ç°**

---

## å››ã€æ ¸å¿ƒæ–¹æ¡ˆï¼šä»¥ Hardhat v3.0.6 ä¸ºé”šç‚¹çš„ç‰ˆæœ¬é”å®šé›†æˆ

### 4.1 ä¸ºä»€ä¹ˆé€‰æ‹© Hardhat v3.0.6ï¼Ÿ

- âœ… æ˜¯ Hardhat 3.x ç³»åˆ—çš„**ç¨³å®š LTS å€™é€‰ç‰ˆæœ¬**
- âœ… æ”¯æŒ EIP-4844ã€EOF ç­‰æ–°ç‰¹æ€§
- âœ… å®˜æ–¹ `hardhat-toolbox` v5+ çš„æ¨èç‰ˆæœ¬
- âœ… ç¤¾åŒºåé¦ˆç¨³å®šï¼Œæ— é‡å¤§å·²çŸ¥ bug

### 4.2 ç‰ˆæœ¬é”å®šç­–ç•¥

æˆ‘ä»¬å®šä¹‰ä¸€ä¸ª **`hardhat-v3.0.6-blueprint.json`** æ–‡ä»¶ï¼Œå£°æ˜æ‰€æœ‰å…¼å®¹ç»„ä»¶ç‰ˆæœ¬ï¼š

```json
{
  "hardhat": "3.0.6",
  "node": "18.18.0",
  "npm": "9.8.1",
  "foundry": "nightly-2025-03-15",
  "slots": {
    "formatting": {
      "prettier": "3.0.3",
      "prettier-plugin-solidity": "1.1.3"
    },
    "linting": {
      "solhint": "3.4.1",
      "eslint": "8.56.0",
      "@nomicfoundation/hardhat-foundry": "0.1.0"
    },
    "security": {
      "slither": "0.9.2"
    },
    "testing": {
      "hardhat-toolbox": "5.0.0",
      "chai": "4.3.10"
    },
    "ci-governance": {
      "commitlint": "19.3.0",
      "husky": "8.0.3"
    }
  },
  "verified": true,
  "test_date": "2025-10-18"
}
```

> âœ… **æ­¤æ–‡ä»¶å³ä¸ºâ€œé›†æˆè¯´æ˜ä¹¦â€**ï¼šä»»ä½•äººæŒ‰æ­¤é…ç½®ï¼Œéƒ½èƒ½è·å¾—ç›¸åŒç¯å¢ƒã€‚

---

## äº”ã€å¿…é¡»é›†æˆçš„ç»„ä»¶åŠå…¶ä½œç”¨ï¼ˆé€é¡¹è¯´æ˜ï¼‰

### 1. `.nvmrc` ä¸ `.npmrc`
- **ä½œç”¨**ï¼šé”å®š Node.js å’Œ npm ç‰ˆæœ¬
- **è§£å†³ç—›ç‚¹**ï¼šé¿å…å›  Node.js ç‰ˆæœ¬å·®å¼‚å¯¼è‡´ `solc` ç¼–è¯‘è¡Œä¸ºä¸åŒ
- **é…ç½®ç¤ºä¾‹**ï¼š
  ```txt
  # .nvmrc
  18.18.0

  # .npmrc
  engine-strict=true
  ```

### 2. `.prettierrc`
- **ä½œç”¨**ï¼šç»Ÿä¸€ Solidity/JS ä»£ç æ ¼å¼
- **è§£å†³ç—›ç‚¹**ï¼šå›¢é˜Ÿåä½œä¸­ä»£ç é£æ ¼æ··ä¹±ï¼ŒPR é¢‘ç¹å› æ ¼å¼è¢«æ‹’
- **é…ç½®ç¤ºä¾‹**ï¼š
  ```json
  {
    "semi": false,
    "singleQuote": true,
    "printWidth": 120,
    "overrides": [
      {
        "files": "*.sol",
        "options": {
          "parser": "solidity-parse",
          "plugins": ["prettier-plugin-solidity"]
        }
      }
    ]
  }
  ```

### 3. `solhint` + `eslint`
- **ä½œç”¨**ï¼šé™æ€ä»£ç æ£€æŸ¥
- **è§£å†³ç—›ç‚¹**ï¼š
  - `solhint`ï¼šæ£€æµ‹ `tx.origin`ã€`reentrancy` ç­‰ Solidity å¸¸è§æ¼æ´
  - `eslint`ï¼šç¡®ä¿ Hardhat é…ç½®è„šæœ¬ï¼ˆJS/TSï¼‰ç¬¦åˆæœ€ä½³å®è·µ
- **èƒ½åŠ›æ”¯æŒ**ï¼š**ä¸»åŠ¨é˜²å¾¡å¸¸è§æ¼æ´**

### 4. `slither`
- **ä½œç”¨**ï¼šè‡ªåŠ¨åŒ–å®‰å…¨åˆ†æ
- **è§£å†³ç—›ç‚¹**ï¼šäººå·¥å®¡è®¡é—æ¼ `uninitialized-state`ã€`incorrect-equality` ç­‰æ¼æ´
- **èƒ½åŠ›æ”¯æŒ**ï¼š**CI ä¸­è‡ªåŠ¨æ‰«æï¼Œé˜»æ–­é«˜å±æ¼æ´åˆå¹¶**

### 5. `commitlint` + `husky`
- **ä½œç”¨**ï¼šè§„èŒƒ Git æäº¤ä¿¡æ¯
- **è§£å†³ç—›ç‚¹**ï¼šæäº¤ä¿¡æ¯æ··ä¹±ï¼Œæ— æ³•è‡ªåŠ¨ç”Ÿæˆ CHANGELOG
- **èƒ½åŠ›æ”¯æŒ**ï¼š**å®ç° Conventional Commitsï¼Œæ”¯æŒè‡ªåŠ¨åŒ–ç‰ˆæœ¬å‘å¸ƒ**

### 6. `foundry`
- **ä½œç”¨**ï¼šè¡¥å…… Hardhat çš„é«˜çº§èƒ½åŠ›
- **è§£å†³ç—›ç‚¹**ï¼š
  - Hardhat æµ‹è¯•é€Ÿåº¦æ…¢ï¼Œä¸æ”¯æŒ invariant testing
  - æ— æ³•è¿›è¡ŒåŸºäºå±æ€§çš„ fuzzing
- **èƒ½åŠ›æ”¯æŒ**ï¼š
  - âœ… **Fuzz Testing**ï¼šå‘ç°è¾¹ç•Œæ¡ä»¶æ¼æ´
  - âœ… **Invariant Testing**ï¼šéªŒè¯åˆçº¦é•¿æœŸè¿è¡Œçš„æ­£ç¡®æ€§
  - âœ… **Gas Snapshots**ï¼šç²¾ç¡®æ¯”è¾ƒå‡½æ•° gas æ¶ˆè€—

---

## å…­ã€å®ç°â€œæ— ç¼é›†æˆâ€çš„å…³é”®æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆå§‹åŒ–é¡¹ç›®
```bash
npx hardhat init --template advanced
nvm use          # è‡ªåŠ¨åˆ‡æ¢åˆ° .nvmrc æŒ‡å®šç‰ˆæœ¬
```

### æ­¥éª¤ 2ï¼šå®‰è£…é”å®šç‰ˆæœ¬ä¾èµ–
```bash
npm install --save-dev \
  hardhat@3.0.6 \
  @nomicfoundation/hardhat-toolbox@5.0.0 \
  prettier@3.0.3 \
  prettier-plugin-solidity@1.1.3 \
  solhint@3.4.1 \
  eslint@8.56.0 \
  @commitlint/cli@19.3.0 \
  husky@8.0.3 \
  slither-analyzer@0.9.2
```

### æ­¥éª¤ 3ï¼šå®‰è£… Foundry
```bash
curl -L https://foundry.paradigm.xyz | bash
foundryup --version nightly-2025-03-15
```

### æ­¥éª¤ 4ï¼šé…ç½®æ’æ§½
- `.solhint.json` â†’ å¯ç”¨ security è§„åˆ™
- `.commitlintrc.json` â†’ å¯ç”¨ type-enum
- `foundry.toml` â†’ è®¾ç½® `test = "test"`ï¼Œä¸ Hardhat å…±äº«æµ‹è¯•ç›®å½•

### æ­¥éª¤ 5ï¼šéªŒè¯ç¯å¢ƒ
```bash
npx hardhat compile
forge test
slither .
```

âœ… **æ­¤æ—¶ï¼Œä½ å·²æ‹¥æœ‰ä¸€ä¸ªï¼š**
- æ ¼å¼ç»Ÿä¸€
- é£æ ¼è§„èŒƒ
- å®‰å…¨æ‰«æ
- å¤šç»´åº¦æµ‹è¯•
- CI å‹å¥½
çš„ç”Ÿäº§çº§ç¯å¢ƒã€‚

---

## ä¸ƒã€ç»“è¯­ï¼šæˆ‘ä»¬éœ€è¦â€œå¼€ç®±å³ç”¨â€çš„ç”Ÿäº§çº§åŸºåº§

æ™ºèƒ½åˆçº¦ä¸æ˜¯ç©å…·ã€‚  
æˆ‘ä»¬ä¸èƒ½å†æ¥å—â€œé…ç½®ç¯å¢ƒèŠ± 3 å¤©ï¼Œå†™åˆçº¦èŠ± 2 å¤©â€çš„è’è¯ç°å®ã€‚

**ä»¥ Hardhat v3.0.6 ä¸ºé”šç‚¹ï¼Œé€šè¿‡æ’æ§½å¼é›†æˆï¼Œé”å®šæ‰€æœ‰ç»„ä»¶ç‰ˆæœ¬ï¼Œå®ç°é›¶è¸©å‘ã€å…¨èƒ½åŠ›è¦†ç›–çš„å¼€å‘ç¯å¢ƒâ€”â€”è¿™ä¸åº”æ˜¯å°‘æ•°æå®¢çš„ç‰¹æƒï¼Œè€Œåº”æ˜¯æ¯ä¸ªé¡¹ç›®å¯åŠ¨çš„ç¬¬ä¸€æ­¥ã€‚**

æˆ‘ä»¬å‘¼åï¼š
> **Hardhat å›¢é˜Ÿæ¨å‡º `hardhat create-production-env` CLIï¼Œå†…ç½®ç»è¿‡éªŒè¯çš„è“å›¾ï¼Œè®©â€œæ­£ç¡®é…ç½®â€æˆä¸ºé»˜è®¤é€‰é¡¹ã€‚**

---

## é™„å½•ï¼šå®Œæ•´é…ç½®æ–‡ä»¶æ¸…å•
- `.nvmrc`
- `.npmrc`
- `package.json`ï¼ˆå¸¦ exact versionsï¼‰
- `.prettierrc`
- `.solhint.json`
- `.eslintrc.js`
- `.commitlintrc.json`
- `husky/pre-commit`
- `foundry.toml`
- `hardhat.config.ts`
- `hardhat-v3.0.6-blueprint.json`ï¼ˆç‰ˆæœ¬é”å®šæ¸…å•ï¼‰

---
