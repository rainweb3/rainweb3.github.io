# Solidity ä¸­ Unicode å­—ç¬¦ä¸²å¤„ç†è§„åˆ™è¯¦è§£ï¼ˆ2025ï¼‰

Solidity è‡ª **0.8.0 ç‰ˆæœ¬**èµ·æ­£å¼æ”¯æŒ Unicode å­—ç¬¦ï¼ˆåŒ…æ‹¬ä¸­æ–‡ã€æ—¥æ–‡ã€éŸ©æ–‡ã€ç‰¹æ®Šç¬¦å·ç­‰ï¼‰ï¼Œä½†è¿™ä¸€æ”¯æŒå¹¶éâ€œå¼€ç®±å³ç”¨â€â€”â€”å¿…é¡»éµå¾ªä¸¥æ ¼çš„è¯­æ³•è§„åˆ™å’Œç¼–ç è§„èŒƒï¼Œå¦åˆ™ä¼šè§¦å‘ç¼–è¯‘é”™è¯¯æˆ–è¿è¡Œæ—¶ä¹±ç ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ‹†è§£ Unicode å­—ç¬¦ä¸²çš„å¤„ç†é€»è¾‘ã€å¸¸è§é™·é˜±ä¸æœ€ä½³å®è·µï¼Œå¸®åŠ©å¼€å‘è€…è§„é¿é—®é¢˜ã€‚

---

## ğŸ“š ç›®å½•

1. [æ ¸å¿ƒè¯­æ³•è§„åˆ™ï¼š`unicode` å‰ç¼€æ˜¯â€œå¼€å…³â€](#ä¸€æ ¸å¿ƒè¯­æ³•è§„åˆ™unicode-å‰ç¼€æ˜¯å¼€å…³)
2. [ç¼–è¯‘ä¸ç¼–ç åº•å±‚é€»è¾‘](#äºŒç¼–è¯‘ä¸ç¼–ç åº•å±‚é€»è¾‘)
3. [ä½¿ç”¨ Unicode å­—ç¬¦çš„â€œä¸‰å¿…é¡»â€å‰æ](#ä¸‰ä½¿ç”¨-unicode-å­—ç¬¦çš„ä¸‰å¿…é¡»å‰æ)
4. [å®Œæ•´ç¤ºä¾‹ï¼šå« Unicode å­—ç¬¦çš„åˆçº¦](#å››å®Œæ•´ç¤ºä¾‹å«-unicode-å­—ç¬¦çš„åˆçº¦)
5. [å…³é”®æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ](#äº”å…³é”®æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ)
6. [å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆFAQï¼‰](#å…­å¸¸è§é—®é¢˜æ’æŸ¥faq)
7. [å·¥å…·é“¾æ”¯æŒç°çŠ¶ï¼šRemixã€Hardhatã€Foundryã€Truffle](#ä¸ƒå·¥å…·é“¾æ”¯æŒç°çŠ¶remixhardhatfoundrytruffle)
8. [æ€»ç»“ï¼šæ ¸å¿ƒè§„åˆ™é€Ÿè®°](#å…«æ€»ç»“æ ¸å¿ƒè§„åˆ™é€Ÿè®°)

---

## ä¸€ã€æ ¸å¿ƒè¯­æ³•è§„åˆ™ï¼š`unicode` å‰ç¼€æ˜¯â€œå¼€å…³â€

Solidity å¯¹å­—ç¬¦ä¸²çš„é»˜è®¤è§£ææ¨¡å¼ä¸º **ASCII ç¼–ç **ï¼ˆä»…æ”¯æŒ 0-127 å·å­—ç¬¦ï¼‰ã€‚è‹¥è¦ä½¿ç”¨é ASCII çš„ Unicode å­—ç¬¦ï¼ˆå¦‚â€œä¸­æ–‡â€â€œí•œê¸€â€â€œæ—¥æœ¬èªâ€ï¼‰ï¼Œå¿…é¡»åœ¨å­—ç¬¦ä¸²å­—é¢é‡å‰æ·»åŠ  **`unicode` å…³é”®å­—å‰ç¼€**ï¼Œæ˜ç¡®å‘ŠçŸ¥ç¼–è¯‘å™¨æŒ‰ UTF-8 æ ¼å¼è§£æã€‚

### 1. é”™è¯¯ä¸æ­£ç¡®å†™æ³•å¯¹æ¯”

| ç±»å‹ | ä»£ç ç¤ºä¾‹ | ç»“æœ | åŸå›  |
|------|----------|------|------|
| âŒ é”™è¯¯ | `require(false, "åªæœ‰æ‹¥æœ‰è€…å¯è°ƒç”¨");` | ç¼–è¯‘å¤±è´¥ï¼š`Invalid character in string literal` | æœªåŠ  `unicode` å‰ç¼€ï¼Œç¼–è¯‘å™¨å°è¯•ç”¨ ASCII è§£æä¸­æ–‡å­—ç¬¦ï¼Œè¯†åˆ«å¤±è´¥ |
| âœ… æ­£ç¡® | `require(false, unicode"åªæœ‰æ‹¥æœ‰è€…å¯è°ƒç”¨");` | ç¼–è¯‘é€šè¿‡ | `unicode` å‰ç¼€æ¿€æ´» UTF-8 è§£æï¼Œä¸­æ–‡å­—ç¬¦è¢«æ­£ç¡®ç¼–ç  |

> ğŸ” **æ³¨æ„**ï¼š`unicode` å‰ç¼€ä»…ç”¨äºå­—ç¬¦ä¸²å­—é¢é‡ï¼ˆstring literalï¼‰ï¼Œä¸ç”¨äºå˜é‡æˆ–è¡¨è¾¾å¼ã€‚

---

### 2. `unicode` å‰ç¼€çš„é€‚ç”¨èŒƒå›´

#### âœ… æ”¯æŒåœºæ™¯

- **ä½œç”¨äºç´§éšå…¶åçš„å­—ç¬¦ä¸²å­—é¢é‡**ï¼Œä¸å½±å“å…¶ä»–å­—ç¬¦ä¸²ï¼š
  ```solidity
  // æ­£ç¡®ï¼šä»…ç¬¬äºŒä¸ªå­—ç¬¦ä¸²åŠ å‰ç¼€
  string public a = "ASCII string"; // çº¯è‹±æ–‡ï¼Œæ— éœ€å‰ç¼€
  string public b = unicode"åŒ…å«ä¸­æ–‡çš„å­—ç¬¦ä¸²"; // éASCIIï¼Œå¿…é¡»åŠ å‰ç¼€
  ```

- **å¯ç”¨äºçŠ¶æ€å˜é‡ã€å‡½æ•°å‚æ•°ã€è¿”å›å€¼ã€äº‹ä»¶å‚æ•°ç­‰ä»»ä½•å­—ç¬¦ä¸²ä¸Šä¸‹æ–‡**ï¼š
  ```solidity
  event LogMessage(string message);
  function emitMessage() external {
      emit LogMessage(unicode"äº‹ä»¶ä¸­åŒ…å«ä¸­æ–‡");
  }
  ```

#### âŒ ä¸æ”¯æŒåœºæ™¯

- **ä¸æ”¯æŒåŠ¨æ€å­—ç¬¦ä¸²æ‹¼æ¥æ—¶ä½¿ç”¨ `unicode` å‰ç¼€**ï¼š
  ```solidity
  // âŒ é”™è¯¯ï¼šä¸èƒ½åœ¨æ‹¼æ¥è¡¨è¾¾å¼å‰åŠ  unicode
  string public wrong = unicode"å‰ç¼€" + "æ‹¼æ¥"; 
  ```

- **æ­£ç¡®åšæ³•ï¼šå…ˆå®šä¹‰å¸¦å‰ç¼€çš„é™æ€å­—ç¬¦ä¸²ï¼Œå†æ‹¼æ¥**ï¼š
  ```solidity
  // âœ… æ­£ç¡®ï¼šå…ˆå®šä¹‰ï¼Œå†æ‹¼æ¥
  string public part1 = unicode"å‰ç¼€";
  string public right = part1 + "æ‹¼æ¥";
  ```

> ğŸ“Œ **æç¤º**ï¼š`unicode` æ˜¯ç¼–è¯‘æ—¶æŒ‡ä»¤ï¼Œä»…å½±å“å­—é¢é‡çš„è§£ææ–¹å¼ï¼Œä¸æ”¹å˜è¿è¡Œæ—¶è¡Œä¸ºã€‚

---

## äºŒã€ç¼–è¯‘ä¸ç¼–ç åº•å±‚é€»è¾‘

æ·»åŠ  `unicode` å‰ç¼€åï¼Œç¼–è¯‘å™¨ä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç¡®ä¿ Unicode å­—ç¬¦æ­£ç¡®åµŒå…¥åˆçº¦å­—èŠ‚ç ã€‚

### 1. UTF-8 ç¼–ç è½¬æ¢

Solidity ä¼šå°† Unicode å­—ç¬¦è½¬æ¢ä¸ºå¯¹åº”çš„ UTF-8 å­—èŠ‚åºåˆ—ï¼š

| å­—ç¬¦ç±»å‹ | ç¤ºä¾‹ | UTF-8 å­—èŠ‚é•¿åº¦ |
|--------|------|----------------|
| è‹±æ–‡/æ•°å­— | `a`, `1` | 1 å­—èŠ‚ |
| ä¸­æ–‡/æ—¥æ–‡/éŸ©æ–‡ | `ä½ `, `ã‚`, `í•œ` | 3 å­—èŠ‚ |
| ç”Ÿåƒ»å­—/æ•°å­¦ç¬¦å· | `ğ €`, `âˆ«`, `ğŒ†` | 4 å­—èŠ‚ |

#### ç¤ºä¾‹ï¼š`unicode"ä½ å¥½"`

- UTF-8 ç¼–ç ä¸ºï¼š`0xE4 0xBD 0xA0 0xE5 0xA5 0xBD`
- æ€»é•¿åº¦ï¼š6 å­—èŠ‚ï¼ˆæ¯ä¸ªæ±‰å­— 3 å­—èŠ‚ï¼‰
- ç¼–è¯‘å™¨å°†è¿™ 6 ä¸ªå­—èŠ‚ç›´æ¥åµŒå…¥åˆçº¦å­—èŠ‚ç 

---

### 2. å­—èŠ‚ç å­˜å‚¨æ ¼å¼

Unicode å­—ç¬¦ä¸²ä¸ ASCII å­—ç¬¦ä¸²åœ¨ Solidity ä¸­å‡ä»¥ **â€œé•¿åº¦ + å­—èŠ‚åºåˆ—â€** æ ¼å¼å­˜å‚¨ï¼š

- ç¤ºä¾‹ï¼š`unicode"ä½ å¥½"` å­˜å‚¨ä¸ºï¼š
    - é•¿åº¦ï¼š`0x06`ï¼ˆ6 å­—èŠ‚ï¼‰
    - å†…å®¹ï¼š`0xE4BD0xA0E5A5BD`ï¼ˆUTF-8 å­—èŠ‚ï¼‰
- å­˜å‚¨ç»“æ„ä¸ ASCII å­—ç¬¦ä¸²ä¸€è‡´ï¼Œä»…å†…å®¹ä¸åŒã€‚

> ğŸ” **æ³¨æ„**ï¼š`bytes.length` è¿”å›çš„æ˜¯ **å­—èŠ‚æ•°**ï¼Œè€Œéå­—ç¬¦æ•°ã€‚`bytes(unicode"ä½ å¥½").length` è¿”å› `6`ï¼Œè€Œé `2`ã€‚

---

## ä¸‰ã€ä½¿ç”¨ Unicode å­—ç¬¦çš„â€œä¸‰å¿…é¡»â€å‰æ

è¦åœ¨ Solidity ä¸­æˆåŠŸä½¿ç”¨ Unicode å­—ç¬¦ï¼ˆæ— ç¼–è¯‘é”™è¯¯ã€æ— è¿è¡Œæ—¶ä¹±ç ï¼‰ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªæ¡ä»¶ï¼Œç¼ºä¸€ä¸å¯ï¼š

### 1. ç¼–è¯‘å™¨ç‰ˆæœ¬ â‰¥ 0.8.0

- **0.8.0 ä¹‹å‰ç‰ˆæœ¬**ï¼šå®Œå…¨ä¸æ”¯æŒ `unicode` å…³é”®å­—ï¼Œå³ä½¿æ·»åŠ å‰ç¼€ä¹Ÿä¼šç¼–è¯‘å¤±è´¥ã€‚
- **æ¨èç‰ˆæœ¬**ï¼šä½¿ç”¨ `^0.8.4` æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œä¿®å¤äº†éƒ¨åˆ† Unicode è§£æ Bug å’Œå®‰å…¨æ¼æ´ã€‚

```solidity
// âŒ é”™è¯¯ï¼š0.7.6 ç‰ˆæœ¬ä¸æ”¯æŒ unicode å‰ç¼€
pragma solidity ^0.7.6;
string public s = unicode"ä¸­æ–‡"; // ç¼–è¯‘å¤±è´¥

// âœ… æ­£ç¡®ï¼šç‰ˆæœ¬ â‰¥ 0.8.0
pragma solidity ^0.8.20;
string public s = unicode"ä¸­æ–‡"; // ç¼–è¯‘é€šè¿‡
```

---

### 2. æºæ–‡ä»¶ç¼–ç ä¸ºâ€œUTF-8 æ—  BOMâ€

- è‹¥åˆçº¦æ–‡ä»¶ä¿å­˜ä¸ºå…¶ä»–ç¼–ç ï¼ˆå¦‚ GBKã€UTF-8 with BOMï¼‰ï¼Œç¼–è¯‘å™¨ä¼šè¯»å–åˆ°é”™è¯¯çš„å­—èŠ‚åºåˆ—ï¼Œå¯¼è‡´ï¼š
    - ç¼–è¯‘é”™è¯¯ï¼š`Invalid UTF-8 byte sequence`
    - è¿è¡Œæ—¶ä¹±ç ï¼šå¦‚â€œä½ å¥½â€æ˜¾ç¤ºä¸ºâ€œæµ£çŠ²ã‚½â€ï¼ˆGBK ç¼–ç è¢«è¯¯è§£æä¸º UTF-8ï¼‰

#### âœ… æ­£ç¡®é…ç½®ï¼ˆä»¥ VS Code ä¸ºä¾‹ï¼‰ï¼š

1. æ‰“å¼€ `.sol` æ–‡ä»¶ï¼›
2. ç‚¹å‡»å³ä¸‹è§’ç¼–ç æ ‡è¯†ï¼ˆå¦‚â€œUTF-8â€ï¼‰ï¼›
3. é€‰æ‹©â€œReopen with Encodingâ€ â†’ â€œUTF-8â€ï¼›
4. å†é€‰æ‹©â€œSave with Encodingâ€ â†’ ç¡®è®¤â€œUTF-8â€ï¼ˆç¡®ä¿æ—  BOMï¼‰ã€‚

> ğŸ“Œ **BOMï¼ˆByte Order Markï¼‰**ï¼šæŸäº›ç¼–è¾‘å™¨é»˜è®¤åœ¨ UTF-8 æ–‡ä»¶å¼€å¤´æ·»åŠ  `EF BB BF` æ ‡è®°ï¼Œå¯èƒ½å¯¼è‡´ Solidity ç¼–è¯‘å™¨è§£æå¼‚å¸¸ã€‚åŠ¡å¿…é€‰æ‹©â€œUTF-8 æ—  BOMâ€ã€‚

---

### 3. æ˜¾å¼æ·»åŠ  `unicode` å‰ç¼€

- å³ä½¿æ»¡è¶³å‰ä¸¤ä¸ªæ¡ä»¶ï¼ŒæœªåŠ å‰ç¼€çš„ Unicode å­—ç¬¦ä¸²ä»ä¼šè§¦å‘ç¼–è¯‘é”™è¯¯â€”â€”è¿™æ˜¯ Solidity ä¸ºå…¼å®¹æ—§ä»£ç ä¿ç•™çš„â€œå®‰å…¨æ£€æŸ¥â€ã€‚

```solidity
// âŒ ç¼–è¯‘å¤±è´¥ï¼šç¼ºå°‘å‰ç¼€
string public msg = "æ¬¢è¿ä½¿ç”¨ Solidity";

// âœ… ç¼–è¯‘é€šè¿‡ï¼šæ·»åŠ å‰ç¼€
string public msg = unicode"æ¬¢è¿ä½¿ç”¨ Solidity";
```

> ğŸ” **ä¾‹å¤–æƒ…å†µ**ï¼š`bytes` ç±»å‹å¯ç›´æ¥åŒ…å« UTF-8 å­—èŠ‚ï¼Œæ— éœ€ `unicode` å‰ç¼€ï¼š
> ```solidity
> bytes public data = "ä½ å¥½"; // åˆæ³•ï¼Œä½†éœ€ç¡®ä¿æ–‡ä»¶ç¼–ç æ­£ç¡®
> ```

---

## å››ã€å®Œæ•´ç¤ºä¾‹ï¼šå« Unicode å­—ç¬¦çš„åˆçº¦

```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20; // æ»¡è¶³ç‰ˆæœ¬è¦æ±‚ï¼ˆâ‰¥0.8.0ï¼‰

contract UnicodeDemo {
    // 1. çŠ¶æ€å˜é‡ï¼šå¸¦ unicode å‰ç¼€çš„ä¸­æ–‡å­—ç¬¦ä¸²
    string public greeting = unicode"ä½ å¥½ï¼ŒSolidityï¼";

    // 2. å‡½æ•°å‚æ•°ï¼šæ¥æ”¶ Unicode å­—ç¬¦ä¸²
    function setGreeting(string calldata newGreeting) external {
        greeting = newGreeting;
    }

    // 3. é”™è¯¯æç¤ºï¼šä½¿ç”¨ä¸­æ–‡æç¤º
    function onlyOwner(address caller, address owner) internal pure {
        require(caller == owner, unicode"é”™è¯¯ï¼šä»…æ‹¥æœ‰è€…å¯è°ƒç”¨æ­¤å‡½æ•°");
    }

    // 4. è¿”å› Unicode å­—ç¬¦ä¸²
    function getMessage() external pure returns (string memory) {
        return unicode"è¿™æ˜¯ä¸€ä¸ªå« Unicode å­—ç¬¦çš„è¿”å›å€¼";
    }

    // 5. äº‹ä»¶ä¸­ä½¿ç”¨ Unicode
    event UserAction(string action);
    function performAction() external {
        emit UserAction(unicode"ç”¨æˆ·æ‰§è¡Œäº†æ“ä½œ");
    }
}
```

---

### å‰ç«¯äº¤äº’æ³¨æ„äº‹é¡¹

- Web3.js å’Œ Ethers.js é»˜è®¤æŒ‰ UTF-8 è§£ç å­—ç¬¦ä¸²è¿”å›å€¼ï¼Œæ— éœ€é¢å¤–å¤„ç†ï¼š
  ```javascript
  const greeting = await contract.greeting();
  console.log(greeting); // è¾“å‡ºï¼š"ä½ å¥½ï¼ŒSolidityï¼"
  ```

- è‹¥éœ€åœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºï¼Œç¡®ä¿æ§åˆ¶å°æ”¯æŒ UTF-8 è¾“å‡ºï¼ˆç°ä»£ç»ˆç«¯å‡æ”¯æŒï¼‰ã€‚

---

## äº”ã€å…³é”®æ³¨æ„äº‹é¡¹ä¸æœ€ä½³å®è·µ

### 1. Gas æˆæœ¬ä¼˜åŒ–ï¼šæ…ç”¨é•¿ Unicode å­—ç¬¦ä¸²

- **éƒ¨ç½²æˆæœ¬**ï¼šé•¿ Unicode å­—ç¬¦ä¸²ä¼šæ˜¾è‘—å¢åŠ åˆçº¦å­—èŠ‚ç ä½“ç§¯ï¼Œæé«˜éƒ¨ç½² Gasã€‚
- **è°ƒç”¨æˆæœ¬**ï¼šä¼ é€’é•¿å­—ç¬¦ä¸²å‚æ•°ä¼šå¢åŠ  Calldata æˆæœ¬ï¼ˆæ¯å­—èŠ‚ 16 Gasï¼Œéé›¶å­—èŠ‚ï¼‰ã€‚

#### âœ… æ¨èä¼˜åŒ–æ–¹æ¡ˆï¼š

- **ä¼˜å…ˆä½¿ç”¨è‡ªå®šä¹‰é”™è¯¯ï¼ˆCustom Errorsï¼‰** æ›¿ä»£ Unicode é”™è¯¯æç¤ºï¼š
  ```solidity
  error OnlyOwner(address caller, address owner);
  function test() external {
      if (msg.sender != owner) revert OnlyOwner(msg.sender, owner);
  }
  ```
    - ä¼˜åŠ¿ï¼šGas æ›´ä½ã€æ”¯æŒå‚æ•°ä¼ é€’ã€å‰ç«¯å¯æœ¬åœ°åŒ–æ˜ å°„ã€‚

- **å‰ç«¯æœ¬åœ°åŒ–æ˜ å°„**ï¼šåˆçº¦è¿”å›ç®€çŸ­é”™è¯¯ç ï¼Œå‰ç«¯æ˜ å°„ä¸ºå¤šè¯­è¨€æç¤ºï¼š
  ```solidity
  require(msg.sender == owner, "ERR_OWNER"); // åˆçº¦è¿”å›è‹±æ–‡çŸ­ç 
  ```
  ```js
  // å‰ç«¯æ˜ å°„
  const messages = { "ERR_OWNER": "ä»…æ‹¥æœ‰è€…å¯è°ƒç”¨" };
  ```

---

### 2. é¿å…â€œéšæ€§ Unicode å­—ç¬¦â€

æŸäº›å­—ç¬¦çœ‹ä¼¼ ASCIIï¼Œå®åˆ™ä¸º Unicode å­—ç¬¦ï¼Œæ˜“å¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼š

| ç±»å‹ | ç¤ºä¾‹ | è¯´æ˜ |
|------|------|------|
| å…¨è§’ç©ºæ ¼ | `ã€€`ï¼ˆU+3000ï¼‰ | ä¸æ˜¯æ™®é€šç©ºæ ¼ï¼ˆU+0020ï¼‰ï¼Œéœ€åŠ  `unicode` å‰ç¼€ |
| ä¸­æ–‡å¼•å· | `â€œâ€` æˆ– `â€˜â€™` | éæ ‡å‡†å¼•å·ï¼Œåº”æ›¿æ¢ä¸ºè‹±æ–‡ `" "` æˆ– `' '` |
| ç‰¹æ®Šç¬¦å· | `â†’`, `â€¢`, `Â§` | å‡ä¸º Unicode å­—ç¬¦ï¼Œéœ€åŠ å‰ç¼€ |

#### âœ… æ­£ç¡®åšæ³•ï¼š

```solidity
// âŒ é”™è¯¯ï¼šåŒ…å«å…¨è§’ç©ºæ ¼
string public wrong = "è¿™æ˜¯ã€€å…¨è§’ç©ºæ ¼";

// âœ… æ­£ç¡®ï¼šåŠ å‰ç¼€æˆ–æ›¿æ¢
string public right1 = unicode"è¿™æ˜¯ã€€å…¨è§’ç©ºæ ¼";
string public right2 = "è¿™æ˜¯ åŠè§’ç©ºæ ¼";
```

---

## å…­ã€å¸¸è§é—®é¢˜æ’æŸ¥ï¼ˆFAQï¼‰

| é—®é¢˜ç°è±¡ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|----------|----------|----------|
| ç¼–è¯‘é”™è¯¯ï¼š`Invalid character in string literal` | 1. æœªåŠ  `unicode` å‰ç¼€ï¼›2. ç¼–è¯‘å™¨ç‰ˆæœ¬ < 0.8.0 | 1. æ·»åŠ  `unicode` å‰ç¼€ï¼›2. å‡çº§ç¼–è¯‘å™¨è‡³ â‰¥0.8.0 |
| ç¼–è¯‘é”™è¯¯ï¼š`Invalid UTF-8 byte sequence` | åˆçº¦æ–‡ä»¶ç¼–ç é UTF-8ï¼ˆå¦‚ GBKï¼‰ | ä½¿ç”¨ VS Code å°†æ–‡ä»¶ä¿å­˜ä¸ºâ€œUTF-8 æ—  BOMâ€ |
| å‰ç«¯æ˜¾ç¤ºä¹±ç ï¼ˆå¦‚â€œæµ£çŠ²ã‚½â€ï¼‰ | å‰ç«¯æœªæŒ‰ UTF-8 è§£æè¿”å›å€¼ | ç¡®ä¿ä½¿ç”¨ Web3.js/Ethers.js ç­‰æ”¯æŒ UTF-8 çš„åº“ |
| `bytes(str).length` è¿”å›å€¼å¼‚å¸¸ | æ··æ·†äº†â€œå­—ç¬¦æ•°â€ä¸â€œå­—èŠ‚æ•°â€ | åœ¨å‰ç«¯ä½¿ç”¨ `Array.from(str).length` è®¡ç®—å­—ç¬¦æ•° |

---

## ä¸ƒã€å·¥å…·é“¾æ”¯æŒç°çŠ¶ï¼šRemixã€Hardhatã€Foundryã€Truffle

ä¸åŒå¼€å‘å·¥å…·å¯¹ Solidity Unicode å­—ç¬¦çš„æ”¯æŒæƒ…å†µå¦‚ä¸‹ï¼Œå»ºè®®æ ¹æ®é¡¹ç›®éœ€æ±‚é€‰æ‹©åˆé€‚çš„å·¥å…·é“¾ã€‚

| å·¥å…· | æ”¯æŒçŠ¶æ€ | é…ç½®è¯´æ˜ | æ¨èæŒ‡æ•° |
|------|----------|----------|----------|
| **Remix IDE** | âœ… å®Œç¾æ”¯æŒ | åœ¨çº¿ IDEï¼Œè‡ªåŠ¨ä½¿ç”¨ `solc` 0.8.0+ï¼Œæ”¯æŒ `unicode` å‰ç¼€å’Œ UTF-8 æ–‡ä»¶è§£æã€‚é€‚åˆå¿«é€ŸéªŒè¯å’Œæ•™å­¦æ¼”ç¤ºã€‚ | â­â­â­â­â­ |
| **Hardhat** | âœ… å®Œç¾æ”¯æŒ | éœ€ç¡®ä¿ `hardhat.config.js` ä¸­æŒ‡å®šçš„ Solidity ç‰ˆæœ¬ â‰¥ 0.8.0ï¼š<br>```js<br>module.exports = {<br>  solidity: "0.8.20"<br>};<br>```<br>æµ‹è¯•æ—¶è‡ªåŠ¨å¤„ç† UTF-8 å­—ç¬¦ä¸²ã€‚ | â­â­â­â­â­ |
| **Foundry** | âœ… å®Œç¾æ”¯æŒ | Foundry ä½¿ç”¨ `solc` ç¼–è¯‘å™¨ï¼Œåªè¦ `remappings.txt` æˆ– `foundry.toml` ä¸­æŒ‡å®šçš„ç‰ˆæœ¬ â‰¥ 0.8.0ï¼Œå³å¯æ”¯æŒ Unicodeï¼š<br>```toml<br>[profile.default]<br>smtlib2 = true<br>solc = "0.8.20"<br>```<br>**æ³¨æ„**ï¼š`.t.sol` æµ‹è¯•æ–‡ä»¶ä¹Ÿéœ€ä¿å­˜ä¸º UTF-8 æ—  BOMã€‚ | â­â­â­â­â­ |
| **Truffle** | âš ï¸ æ”¯æŒä½†éœ€æ³¨æ„ | Truffle 5.5.0+ æ”¯æŒ Solidity 0.8.xï¼Œä½†éœ€æ‰‹åŠ¨é…ç½® `truffle-config.js`ï¼š<br>```js<br>module.exports = {<br>  compilers: {<br>    solc: {<br>      version: "0.8.20"<br>    }<br>  }<br>};<br>```<br>**è­¦å‘Š**ï¼šTruffle çš„æ’ä»¶ç”Ÿæ€æ›´æ–°ç¼“æ…¢ï¼Œä¸æ¨èç”¨äºæ–°é¡¹ç›®ã€‚ | â­â­â˜† |

### Foundry ç‰¹åˆ«è¯´æ˜

- **ç¼–è¯‘æ”¯æŒ**ï¼š`forge build` è‡ªåŠ¨è°ƒç”¨ `solc`ï¼Œåªè¦ç‰ˆæœ¬ â‰¥ 0.8.0ï¼Œå³å¯æ­£ç¡®ç¼–è¯‘å« `unicode` å‰ç¼€çš„å­—ç¬¦ä¸²ã€‚
- **æµ‹è¯•æ”¯æŒ**ï¼šåœ¨ `.t.sol` æµ‹è¯•åˆçº¦ä¸­ä½¿ç”¨ Unicode å­—ç¬¦ä¸²æ—¶ï¼Œéœ€ç¡®ä¿æ–‡ä»¶ç¼–ç ä¸º UTF-8 æ—  BOMã€‚
- **é¢„æœŸé”™è¯¯æµ‹è¯•**ï¼šä½¿ç”¨ `vm.expectRevert()` æ—¶ï¼Œè‹¥ `require` æç¤ºä¸º Unicode å­—ç¬¦ä¸²ï¼Œéœ€åœ¨æµ‹è¯•ä¸­ä½¿ç”¨ç›¸åŒå‰ç¼€ï¼š
  ```solidity
  // è¢«æµ‹è¯•å‡½æ•°
  function risky() external {
      require(false, unicode"æ“ä½œå¤±è´¥");
  }

  // æµ‹è¯•ç”¨ä¾‹ï¼ˆ.t.solï¼‰
  function testRiskyFails() public {
      vm.expectRevert(unicode"æ“ä½œå¤±è´¥");
      target.risky();
  }
  ```
- **ä¼˜åŠ¿**ï¼šFoundry ç¼–è¯‘é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤§å‹é¡¹ç›®ä¸­é¢‘ç¹ç¼–è¯‘å« Unicode çš„åˆçº¦ã€‚

---

## å…«ã€æ€»ç»“ï¼šæ ¸å¿ƒè§„åˆ™é€Ÿè®°

| è§„åˆ™ | è¯´æ˜ |
|------|------|
| âœ… **ç‰ˆæœ¬å¤Ÿ** | ç¼–è¯‘å™¨ç‰ˆæœ¬ â‰¥ 0.8.0ï¼ˆæ¨è `^0.8.20`ï¼‰ |
| âœ… **ç¼–ç å¯¹** | æºæ–‡ä»¶ä¿å­˜ä¸º **UTF-8 æ—  BOM** |
| âœ… **å‰ç¼€åŠ ** | Unicode å­—ç¬¦ä¸²å‰å¿…é¡»åŠ  `unicode` å‰ç¼€ |
| âœ… **Gas çœ** | ç”Ÿäº§ç¯å¢ƒä¼˜å…ˆä½¿ç”¨ **è‡ªå®šä¹‰é”™è¯¯** æ›¿ä»£é•¿ Unicode æç¤º |
| âœ… **é¿å‘æŸ¥** | æ£€æŸ¥éšæ€§ Unicode å­—ç¬¦ï¼ˆå…¨è§’ç©ºæ ¼ã€ä¸­æ–‡å¼•å·ç­‰ï¼‰ |
| âœ… **å·¥å…·é€‰** | æ¨èä½¿ç”¨ **Remix**ï¼ˆæ•™å­¦ï¼‰ã€**Hardhat**ï¼ˆå¼€å‘ï¼‰ã€**Foundry**ï¼ˆé«˜æ€§èƒ½ï¼‰ |

---

> ğŸ **æœ€ç»ˆå»ºè®®**ï¼š  
> Unicode å­—ç¬¦ä¸²åœ¨ **åŸå‹éªŒè¯ã€å­¦ä¹ æ¼”ç¤º** ä¸­éå¸¸å®ç”¨ï¼Œå¯æå‡ä»£ç å¯è¯»æ€§ã€‚ä½†åœ¨ **ç”Ÿäº§ç¯å¢ƒ** ä¸­ï¼Œåº”ä¼˜å…ˆè€ƒè™‘ **Gas æˆæœ¬ã€å¯ç»´æŠ¤æ€§ã€è°ƒè¯•æ•ˆç‡**ï¼Œæ¨èä½¿ç”¨ **è‡ªå®šä¹‰é”™è¯¯ + å‰ç«¯æœ¬åœ°åŒ–æ˜ å°„** çš„ç»„åˆæ–¹æ¡ˆï¼Œå…¼é¡¾æ€§èƒ½ä¸ç”¨æˆ·ä½“éªŒã€‚
>
> **å·¥å…·é“¾é€‰æ‹©å»ºè®®**ï¼š
> - æ–°é¡¹ç›®ï¼šä¼˜å…ˆä½¿ç”¨ **Hardhat** æˆ– **Foundry**
> - å¿«é€ŸéªŒè¯ï¼šä½¿ç”¨ **Remix**
> - é—ç•™é¡¹ç›®ç»´æŠ¤ï¼šå¯ç»§ç»­ä½¿ç”¨ **Truffle**
